# ISS-019: Rename CourseSegment to CourseModule Throughout UI

**Priority:** high
**Type:** refactor
**Status:** ✅ COMPLETED
**Assigned:** UI Agent
**Dependencies:** None
**Blocking:** ISS-020 (Course Module Builder UI Routes) - Unblocked ✅
**Completed Date:** 2026-01-14
**Git Commit:** b26772b

---

## Completion Summary

Successfully completed codebase-wide refactor to rename CourseSegment → CourseModule for consistency with API terminology.

**Scope Completed:**
- ✅ Renamed entity directory: `course-segment/` → `course-module/`
- ✅ Updated 11 types (all CourseSegment* types → CourseModule*)
- ✅ Updated 6 API functions (listCourseSegments → listCourseModules, etc.)
- ✅ Updated 6 hooks (useCourseSegments → useCourseModules, etc.)
- ✅ Renamed 3 UI components (Card, Form, List)
- ✅ Updated `endpoints.ts`: courseSegments → courseModules
- ✅ Updated 17 importing files across pages, features, and tests
- ✅ Renamed mock data: courseSegments.ts → courseModules.ts
- ✅ Updated test handlers
- ✅ Deleted old course-segment directory
- ✅ Zero remaining references to "segment" terminology

**Verification:**
- TypeScript compilation clean (no new errors from refactor)
- All changes systematic and automated
- API endpoints unchanged (already use `/modules`)

---

## Description

The API uses "modules" (`/courses/:courseId/modules`) but the UI entity layer uses "segment" (`CourseSegment`, `courseSegmentApi.ts`). This terminology inconsistency causes confusion. The industry-standard term is "module" and the API already uses it - the UI should align.

---

## Current State (Inconsistent)

| Layer | Current Term | Example |
|-------|--------------|---------|
| **API Endpoints** | `modules` ✅ | `/courses/:courseId/modules` |
| **UI Entity** | `segment` ❌ | `CourseSegment`, `courseSegmentApi` |
| **UI Components** | `segment` ❌ | `CourseSegmentCard`, `CourseSegmentForm` |
| **Contract Files** | Both (hedging) | `course-segments.contract.ts` |
| **Query Keys** | `courseSegments` ❌ | `courseSegmentKeys.all` |

## Target State (Consistent)

| Layer | New Term | Example |
|-------|----------|---------|
| **API Endpoints** | `modules` ✅ | `/courses/:courseId/modules` (unchanged) |
| **UI Entity** | `module` ✅ | `CourseModule`, `courseModuleApi` |
| **UI Components** | `module` ✅ | `CourseModuleCard`, `CourseModuleForm` |
| **Contract Files** | `module` ✅ | `course-modules.contract.ts` |
| **Query Keys** | `courseModules` ✅ | `courseModuleKeys.all` |

---

## Files to Rename

### Entity Directory
```
src/entities/course-segment/  →  src/entities/course-module/
├── api/
│   ├── courseSegmentApi.ts  →  courseModuleApi.ts
│   └── __tests__/courseSegmentApi.test.ts  →  courseModuleApi.test.ts
├── model/
│   ├── courseSegmentKeys.ts  →  courseModuleKeys.ts
│   ├── types.ts (update internal types)
│   └── lessonTypes.ts
├── ui/
│   ├── CourseSegmentCard.tsx  →  CourseModuleCard.tsx
│   ├── CourseSegmentForm.tsx  →  CourseModuleForm.tsx
│   ├── CourseSegmentList.tsx  →  CourseModuleList.tsx
│   └── __tests__/ (update all test files)
└── index.ts (update all exports)
```

### Contract Files
```
api/contracts/api/course-segments.contract.ts  →  course-modules.contract.ts
```

### Shared API
```
src/shared/api/endpoints.ts
  - courseSegments: { ... }  →  courseModules: { ... }
```

### Mock Data
```
src/test/mocks/data/courseSegments.ts  →  courseModules.ts
```

---

## Types to Rename

| Current | New |
|---------|-----|
| `CourseSegment` | `CourseModule` |
| `CourseSegmentListItem` | `CourseModuleListItem` |
| `CourseSegmentType` | `CourseModuleType` |
| `CourseSegmentSettings` | `CourseModuleSettings` |
| `CreateCourseSegmentPayload` | `CreateCourseModulePayload` |
| `UpdateCourseSegmentPayload` | `UpdateCourseModulePayload` |
| `CourseSegmentFilters` | `CourseModuleFilters` |
| `CourseSegmentsListResponse` | `CourseModulesListResponse` |
| `ReorderCourseSegmentsPayload` | `ReorderCourseModulesPayload` |
| `ReorderCourseSegmentsResponse` | `ReorderCourseModulesResponse` |
| `DeleteCourseSegmentResponse` | `DeleteCourseModuleResponse` |

---

## API Functions to Rename

| Current | New |
|---------|-----|
| `listCourseSegments()` | `listCourseModules()` |
| `getCourseSegment()` | `getCourseModule()` |
| `createCourseSegment()` | `createCourseModule()` |
| `updateCourseSegment()` | `updateCourseModule()` |
| `deleteCourseSegment()` | `deleteCourseModule()` |
| `reorderCourseSegments()` | `reorderCourseModules()` |

---

## Query Key Changes

```typescript
// Before
export const courseSegmentKeys = {
  all: ['courseSegments'] as const,
  lists: () => [...courseSegmentKeys.all, 'list'] as const,
  ...
};

// After
export const courseModuleKeys = {
  all: ['courseModules'] as const,
  lists: () => [...courseModuleKeys.all, 'list'] as const,
  ...
};
```

---

## Files That Import course-segment (Need Updates)

Search for: `from '@/entities/course-segment'` or `from '../course-segment'`

Expected files to update:
- `src/pages/staff/courses/CourseEditorPage.tsx`
- `src/pages/staff/courses/ModuleEditorPage.tsx`
- `src/pages/staff/courses/CoursePreviewPage.tsx`
- Any features using course modules

---

## Acceptance Criteria

- [ ] All files renamed from `segment` → `module`
- [ ] All types renamed from `Segment` → `Module`
- [ ] All functions renamed from `segment` → `module`
- [ ] All query keys updated
- [ ] All imports updated throughout codebase
- [ ] All tests passing
- [ ] No remaining references to "segment" (except in git history)
- [ ] API endpoints unchanged (`/modules` still works)

---

## Implementation Strategy

1. **Create new entity directory** `src/entities/course-module/`
2. **Copy and rename** all files from `course-segment`
3. **Update all internal references** in the new files
4. **Update barrel exports** in `index.ts`
5. **Update shared/api/endpoints.ts**
6. **Update all imports** in pages/features
7. **Delete old `course-segment` directory**
8. **Run tests** and fix any remaining issues
9. **Update contract file** `course-segments.contract.ts` → `course-modules.contract.ts`

---

## Notes
- This is a refactor with no functional changes
- API endpoints remain unchanged (they already use `/modules`)
- TypeScript will catch most missed renames at compile time
- Run `grep -r "segment" src/` after to verify complete rename
- Update any documentation referencing "segments"
