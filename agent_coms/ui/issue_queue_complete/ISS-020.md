# ISS-020: Wire Up Staff Course Builder Routes

**Priority:** high
**Type:** feature
**Status:** ✅ COMPLETED
**Assigned:** UI Agent
**Dependencies:** ISS-019 (Segment → Module rename must complete first) - Resolved ✅
**Completed Date:** 2026-01-14
**Git Commit:** b26772b

---

## Completion Summary

Staff course builder routes were ALREADY IMPLEMENTED in the router (lines 382-449). Only missing piece was the navigation link, which has been added.

**What Was Found:**
- ✅ Routes `/staff/courses` - Already existed (StaffCoursesPage)
- ✅ Route `/staff/courses/new` - Already existed (CourseEditorPage)
- ✅ Route `/staff/courses/:courseId/edit` - Already existed (CourseEditorPage)
- ✅ Route `/staff/courses/:courseId/modules/:moduleId/edit` - Already existed (ModuleEditorPage)
- ✅ Route `/staff/courses/content/upload` - Already existed (ContentUploaderPage)
- ✅ Route `/staff/courses/exercises/new` - Already existed (ExerciseBuilderPage)
- ✅ Route `/staff/courses/exercises/:exerciseId` - Already existed (ExerciseBuilderPage)
- ✅ Route `/staff/courses/:courseId/preview` - Already existed (CoursePreviewPage)
- ✅ Route `/staff/courses/:courseId/preview/:moduleId` - Already existed (CoursePreviewPage)
- ✅ All routes protected with `<StaffOnlyRoute>`

**What Was Added:**
- ✅ Navigation link "My Courses" to staff sidebar (STAFF_CONTEXT_NAV)
- ✅ Position: First item in staff context navigation
- ✅ Icon: BookOpen
- ✅ Permission: content:courses:read
- ✅ Department scoped: false

**Impact:**
- Staff users can now access course builder via sidebar navigation
- All course management pages are now discoverable
- No route changes needed - just navigation enhancement

---

## Description

The staff course builder pages exist but are not connected to the router. Staff users need access to course creation and management tools. This issue wires up the existing pages to proper routes.

---

## Existing Pages (Ready but Not Routed)

| Page | File | Purpose |
|------|------|---------|
| `StaffCoursesPage` | `src/pages/staff/courses/StaffCoursesPage.tsx` | Course list + "Create Course" button |
| `CourseEditorPage` | `src/pages/staff/courses/CourseEditorPage.tsx` | Edit course details + manage modules |
| `ModuleEditorPage` | `src/pages/staff/courses/ModuleEditorPage.tsx` | Edit individual module |
| `ContentUploaderPage` | `src/pages/staff/courses/ContentUploaderPage.tsx` | Upload SCORM/video content |
| `ExerciseBuilderPage` | `src/pages/staff/courses/ExerciseBuilderPage.tsx` | Create custom exercises |
| `CoursePreviewPage` | `src/pages/staff/courses/CoursePreviewPage.tsx` | ✅ Already routed |

---

## Routes to Add

```tsx
// src/app/routing/index.tsx

// Staff Course Management Routes
<Route path="/staff/courses" element={<StaffCoursesPage />} />
<Route path="/staff/courses/create" element={<CourseEditorPage />} />
<Route path="/staff/courses/:courseId/edit" element={<CourseEditorPage />} />
<Route path="/staff/courses/:courseId/modules/:moduleId" element={<ModuleEditorPage />} />
<Route path="/staff/courses/:courseId/modules/:moduleId/content" element={<ContentUploaderPage />} />
<Route path="/staff/courses/:courseId/modules/:moduleId/exercises" element={<ExerciseBuilderPage />} />

// Already exists:
<Route path="/staff/courses/:courseId/preview" element={<CoursePreviewPage />} />
<Route path="/staff/courses/:courseId/preview/:moduleId" element={<CoursePreviewPage />} />
```

---

## Navigation Updates

Add to staff sidebar navigation (`navItems.ts`):

```typescript
// In STAFF_NAV_ITEMS or appropriate section
{
  label: 'My Courses',
  path: '/staff/courses',
  icon: BookOpen,
  permissions: ['content:courses:read'],
},
```

---

## Route Protection

All routes should be protected:
- Require `staff` or `global-admin` userType
- Specific routes may require additional permissions:
  - Create: `content:courses:manage`
  - Edit: `content:courses:manage`
  - Delete: `content:courses:manage`

---

## Page State Handling

### StaffCoursesPage (`/staff/courses`)
- Shows courses the current user can manage
- Filter by department context if applicable
- "Create Course" button (permission-gated)

### CourseEditorPage (`/staff/courses/create` vs `/staff/courses/:courseId/edit`)
- Detect create vs edit mode via route params
- `courseId ? 'edit' : 'create'` pattern
- Pre-populate form in edit mode

### ModuleEditorPage (`/staff/courses/:courseId/modules/:moduleId`)
- Get courseId and moduleId from params
- Validate user has access to this course
- Show breadcrumb: Course > Module

---

## Acceptance Criteria

- [ ] All routes registered in router
- [ ] Routes protected by authentication
- [ ] Routes protected by appropriate permissions
- [ ] Navigation item added to staff sidebar
- [ ] Create/Edit mode works correctly for CourseEditorPage
- [ ] Breadcrumb navigation works across pages
- [ ] Back buttons navigate correctly
- [ ] URLs are bookmarkable

---

## Related Files

**Router:**
- `src/app/routing/index.tsx` - Add new routes

**Navigation:**
- `src/widgets/sidebar/config/navItems.ts` - Add "My Courses" link

**Pages:**
- `src/pages/staff/courses/index.ts` - Ensure all exports

**Specs:**
- [COURSE_ROLE_FUNCTION_MATRIX.md](../specs/COURSE_ROLE_FUNCTION_MATRIX.md) - Role-based route access
- [CONTENT_ADMIN_FLOW_DESIGN.md](../specs/CONTENT_ADMIN_FLOW_DESIGN.md) - Content admin navigation flow

---

## Notes
- Pages already exist, this is primarily routing work
- Depends on ISS-019 completing first (module terminology)
- Consider lazy loading for performance: `React.lazy(() => import(...))`
- May need to add route protection via `<ProtectedRoute>`
